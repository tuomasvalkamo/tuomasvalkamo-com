---
title: It's raining shells - Pen Testing Week 2
date: "2022-11-04T17:46:37.121Z"
description: Penetration testing using Metasploitable.
---

Course material: https://terokarvinen.com/2022/tunkeutumistestaus-ict4tn027-3010-syksylla-2022/

Environment: VirtualBox VM running Kali Linux. VM has 2 GB of RAM and 80 GB of disk space.

## Read and summarize

**Objective: Read the Jaswal 2020: Mastering Metasploit - 4th edition: Chapter 1: Approaching Penetration Test Using Metasploit (start from "Conducting a penetration test with Metasploit")**

Basic terms used in Metasploit:
  - Exploits (code that is exploit target vulnerability)
  - Payload (code that runs in the target after successful explotation)
  - Auxiliary (Metasploit modules that give additional functionality)
  - Encoders (Obfuscate modules to avoid detection)
  - Meterpreter (Payload that uses DLL injection. Provides additional functionality that can be run on the target system.)

- Benefits of Metasploit:
  - Open source
  - Support for testing large networks and natural naming conventions
  - Smart payload generation and switching mechanism (Meterpreter)
  - Cleaner exits. Metasploit often doesn't crash the target system on exit where others might.

## Metasploitable

**Objective: Install Metasploitable 2 to the same Host-only network with your attacking computer.**

(I did this step earlier so I'm writing from what I remember)

### Install and configure

I downloaded [Metasploitable 2](https://sourceforge.net/projects/metasploitable/), unzipped the file, and added the VM to my VirtualBox by clicking Add > Machine. For options, I set *Type* to unknown and *Version* to unknown 64-bit.

To configure the Host-only network connection I clicked on File > Host Network Manager, inside VirtualBox. I created a new Host-only network by clicking the Create button in the top left corner and enabled DHCP Server by clicking the box in the row where my new network was listed.

![metasploitable host network manager settings](metasploitable-host-network-manager-settings.png)

To set the Host-only network to Metasploitable 2, I clicked on the settings button of my Metasploitable 2 VM. In the Network tab, I changed *Adapter 1* to be attached to Host-only Adapter and the name to be the new Host-only network I had configured.

![metasploitable host-only network settings](metasploitable-host-only-network-settings.png)

I did the same to my Kali Linux VM except I added the Host-only network to *Adapter 2*, leaving *Adapter 1* to the default NAT. This was done so that I could enable Internet connection in Kali if I so wished.

### Testing the connection

I started up Kali Linux and pinged www.google.com. I got back a response which I expected. 

![pinging google, got response](kali-linux-ping-google.png)

I opened Kali network settings and disconnected the Adapter 1 NAT cable. This was so that there would be no access to the outside Internet during the penetration testing.

![kali linux network settings](kali-linux-host-only-network-settings.png)

I pinged www.google.com again and this time I got no response, as expected.

![pinging google, no response](kali-linux-ping-google-fail.png)

I started the Metasploitable 2 VM, logged in the default credentials, and pinged www.google.com. I got no response which confirmed that the machine was not connected to the Internet.

![metasploitable 2 ping google fail](metasploitable-ping-google-fail.png)

I looked up my local IP address for the Metasploitable 2 machine by typing the *ifconfig* command

    $ ifconfig

![ifconfig local ip](ifconfig-local-ip.png)

I pinged the Metasploitable 2 local IP in Kali to confirm that the both the machines were operating on the same network. The ping received a response which confirmed it.

![pinging local IP](ping-local-ip-host-only-network.png)

## Port scanning Metasploitable

**Objective: Port scan Metasploitable 2. Utilize additional techiques (banner grabbing, NSE...). Analyze results of the port scan. Store port scan results to Metasploitable DB and files.**